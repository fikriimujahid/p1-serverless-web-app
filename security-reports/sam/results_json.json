{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_76", "bc_check_id": "BC_AWS_LOGGING_17", "check_name": "Ensure API Gateway has Access Logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/AccessLogSetting/DestinationArn"]}, "code_block": [[39, "  NotesApi:\r\n"], [40, "    Type: AWS::Serverless::Api\r\n"], [41, "    Properties:\r\n"], [42, "      Name: !Sub 'notes-api-${Environment}'\r\n"], [43, "      StageName: !Ref Environment\r\n"], [44, "      TracingEnabled: true\r\n"], [45, "      Cors:\r\n"], [46, "        AllowMethods: \"'GET,POST,PUT,DELETE,OPTIONS'\"\r\n"], [47, "        AllowHeaders: \"'Content-Type,Authorization'\"\r\n"], [48, "        AllowOrigin: \"'*'\"\r\n"], [49, "      Auth:\r\n"], [50, "        DefaultAuthorizer: CognitoAuthorizer\r\n"], [51, "        Authorizers:\r\n"], [52, "          CognitoAuthorizer:\r\n"], [53, "            UserPoolArn: !Sub 'arn:aws:cognito-idp:ap-southeast-1:${AWS::AccountId}:userpool/${UserPoolId}'\r\n"], [54, "            Identity:\r\n"], [55, "              RevalidateEvery: 3600\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [39, 55], "resource": "AWS::Serverless::Api.NotesApi", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayAccessLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-17", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"StageName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "Name": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_120", "bc_check_id": "BC_AWS_GENERAL_128", "check_name": "Ensure API Gateway caching is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/CacheClusterEnabled"]}, "code_block": [[39, "  NotesApi:\r\n"], [40, "    Type: AWS::Serverless::Api\r\n"], [41, "    Properties:\r\n"], [42, "      Name: !Sub 'notes-api-${Environment}'\r\n"], [43, "      StageName: !Ref Environment\r\n"], [44, "      TracingEnabled: true\r\n"], [45, "      Cors:\r\n"], [46, "        AllowMethods: \"'GET,POST,PUT,DELETE,OPTIONS'\"\r\n"], [47, "        AllowHeaders: \"'Content-Type,Authorization'\"\r\n"], [48, "        AllowOrigin: \"'*'\"\r\n"], [49, "      Auth:\r\n"], [50, "        DefaultAuthorizer: CognitoAuthorizer\r\n"], [51, "        Authorizers:\r\n"], [52, "          CognitoAuthorizer:\r\n"], [53, "            UserPoolArn: !Sub 'arn:aws:cognito-idp:ap-southeast-1:${AWS::AccountId}:userpool/${UserPoolId}'\r\n"], [54, "            Identity:\r\n"], [55, "              RevalidateEvery: 3600\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [39, 55], "resource": "AWS::Serverless::Api.NotesApi", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.APIGatewayCacheEnable", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"StageName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "Name": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[58, "  ReadNotesFunction:\r\n"], [59, "    Type: AWS::Serverless::Function\r\n"], [60, "    Properties:\r\n"], [61, "      FunctionName: !Sub 'notes-read-${Environment}'\r\n"], [62, "      CodeUri: .\r\n"], [63, "      Handler: dist/handlers/notes/readHandler.handler\r\n"], [64, "      Environment:\r\n"], [65, "        Variables:\r\n"], [66, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [67, "      Events:\r\n"], [68, "        ListNotes:\r\n"], [69, "          Type: Api\r\n"], [70, "          Properties:\r\n"], [71, "            RestApiId: !Ref NotesApi\r\n"], [72, "            Path: /notes\r\n"], [73, "            Method: GET\r\n"], [74, "        GetNote:\r\n"], [75, "          Type: Api\r\n"], [76, "          Properties:\r\n"], [77, "            RestApiId: !Ref NotesApi\r\n"], [78, "            Path: /notes/{id}\r\n"], [79, "            Method: GET\r\n"], [80, "      Policies:\r\n"], [81, "        - DynamoDBReadPolicy:\r\n"], [82, "            TableName: !Ref DynamoDBTableName\r\n"], [83, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [84, "      Tags:\r\n"], [85, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [58, 85], "resource": "AWS::Serverless::Function.ReadNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[58, "  ReadNotesFunction:\r\n"], [59, "    Type: AWS::Serverless::Function\r\n"], [60, "    Properties:\r\n"], [61, "      FunctionName: !Sub 'notes-read-${Environment}'\r\n"], [62, "      CodeUri: .\r\n"], [63, "      Handler: dist/handlers/notes/readHandler.handler\r\n"], [64, "      Environment:\r\n"], [65, "        Variables:\r\n"], [66, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [67, "      Events:\r\n"], [68, "        ListNotes:\r\n"], [69, "          Type: Api\r\n"], [70, "          Properties:\r\n"], [71, "            RestApiId: !Ref NotesApi\r\n"], [72, "            Path: /notes\r\n"], [73, "            Method: GET\r\n"], [74, "        GetNote:\r\n"], [75, "          Type: Api\r\n"], [76, "          Properties:\r\n"], [77, "            RestApiId: !Ref NotesApi\r\n"], [78, "            Path: /notes/{id}\r\n"], [79, "            Method: GET\r\n"], [80, "      Policies:\r\n"], [81, "        - DynamoDBReadPolicy:\r\n"], [82, "            TableName: !Ref DynamoDBTableName\r\n"], [83, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [84, "      Tags:\r\n"], [85, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [58, 85], "resource": "AWS::Serverless::Function.ReadNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[58, "  ReadNotesFunction:\r\n"], [59, "    Type: AWS::Serverless::Function\r\n"], [60, "    Properties:\r\n"], [61, "      FunctionName: !Sub 'notes-read-${Environment}'\r\n"], [62, "      CodeUri: .\r\n"], [63, "      Handler: dist/handlers/notes/readHandler.handler\r\n"], [64, "      Environment:\r\n"], [65, "        Variables:\r\n"], [66, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [67, "      Events:\r\n"], [68, "        ListNotes:\r\n"], [69, "          Type: Api\r\n"], [70, "          Properties:\r\n"], [71, "            RestApiId: !Ref NotesApi\r\n"], [72, "            Path: /notes\r\n"], [73, "            Method: GET\r\n"], [74, "        GetNote:\r\n"], [75, "          Type: Api\r\n"], [76, "          Properties:\r\n"], [77, "            RestApiId: !Ref NotesApi\r\n"], [78, "            Path: /notes/{id}\r\n"], [79, "            Method: GET\r\n"], [80, "      Policies:\r\n"], [81, "        - DynamoDBReadPolicy:\r\n"], [82, "            TableName: !Ref DynamoDBTableName\r\n"], [83, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [84, "      Tags:\r\n"], [85, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [58, 85], "resource": "AWS::Serverless::Function.ReadNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[58, "  ReadNotesFunction:\r\n"], [59, "    Type: AWS::Serverless::Function\r\n"], [60, "    Properties:\r\n"], [61, "      FunctionName: !Sub 'notes-read-${Environment}'\r\n"], [62, "      CodeUri: .\r\n"], [63, "      Handler: dist/handlers/notes/readHandler.handler\r\n"], [64, "      Environment:\r\n"], [65, "        Variables:\r\n"], [66, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [67, "      Events:\r\n"], [68, "        ListNotes:\r\n"], [69, "          Type: Api\r\n"], [70, "          Properties:\r\n"], [71, "            RestApiId: !Ref NotesApi\r\n"], [72, "            Path: /notes\r\n"], [73, "            Method: GET\r\n"], [74, "        GetNote:\r\n"], [75, "          Type: Api\r\n"], [76, "          Properties:\r\n"], [77, "            RestApiId: !Ref NotesApi\r\n"], [78, "            Path: /notes/{id}\r\n"], [79, "            Method: GET\r\n"], [80, "      Policies:\r\n"], [81, "        - DynamoDBReadPolicy:\r\n"], [82, "            TableName: !Ref DynamoDBTableName\r\n"], [83, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [84, "      Tags:\r\n"], [85, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [58, 85], "resource": "AWS::Serverless::Function.ReadNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBReadPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[88, "  WriteNotesFunction:\r\n"], [89, "    Type: AWS::Serverless::Function\r\n"], [90, "    Properties:\r\n"], [91, "      FunctionName: !Sub 'notes-write-${Environment}'\r\n"], [92, "      CodeUri: .\r\n"], [93, "      Handler: dist/handlers/notes/writeHandler.handler\r\n"], [94, "      Environment:\r\n"], [95, "        Variables:\r\n"], [96, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [97, "      Events:\r\n"], [98, "        NotesOptions:\r\n"], [99, "          Type: Api\r\n"], [100, "          Properties:\r\n"], [101, "            RestApiId: !Ref NotesApi\r\n"], [102, "            Path: /notes\r\n"], [103, "            Method: OPTIONS\r\n"], [104, "            Auth:\r\n"], [105, "              Authorizer: NONE\r\n"], [106, "        CreateNote:\r\n"], [107, "          Type: Api\r\n"], [108, "          Properties:\r\n"], [109, "            RestApiId: !Ref NotesApi\r\n"], [110, "            Path: /notes\r\n"], [111, "            Method: POST\r\n"], [112, "        NoteByIdOptions:\r\n"], [113, "          Type: Api\r\n"], [114, "          Properties:\r\n"], [115, "            RestApiId: !Ref NotesApi\r\n"], [116, "            Path: /notes/{id}\r\n"], [117, "            Method: OPTIONS\r\n"], [118, "            Auth:\r\n"], [119, "              Authorizer: NONE\r\n"], [120, "        UpdateNote:\r\n"], [121, "          Type: Api\r\n"], [122, "          Properties:\r\n"], [123, "            RestApiId: !Ref NotesApi\r\n"], [124, "            Path: /notes/{id}\r\n"], [125, "            Method: PUT\r\n"], [126, "        DeleteNote:\r\n"], [127, "          Type: Api\r\n"], [128, "          Properties:\r\n"], [129, "            RestApiId: !Ref NotesApi\r\n"], [130, "            Path: /notes/{id}\r\n"], [131, "            Method: DELETE\r\n"], [132, "      Policies:\r\n"], [133, "        - DynamoDBCrudPolicy:\r\n"], [134, "            TableName: !Ref DynamoDBTableName\r\n"], [135, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [136, "      Tags:\r\n"], [137, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [88, 137], "resource": "AWS::Serverless::Function.WriteNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[88, "  WriteNotesFunction:\r\n"], [89, "    Type: AWS::Serverless::Function\r\n"], [90, "    Properties:\r\n"], [91, "      FunctionName: !Sub 'notes-write-${Environment}'\r\n"], [92, "      CodeUri: .\r\n"], [93, "      Handler: dist/handlers/notes/writeHandler.handler\r\n"], [94, "      Environment:\r\n"], [95, "        Variables:\r\n"], [96, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [97, "      Events:\r\n"], [98, "        NotesOptions:\r\n"], [99, "          Type: Api\r\n"], [100, "          Properties:\r\n"], [101, "            RestApiId: !Ref NotesApi\r\n"], [102, "            Path: /notes\r\n"], [103, "            Method: OPTIONS\r\n"], [104, "            Auth:\r\n"], [105, "              Authorizer: NONE\r\n"], [106, "        CreateNote:\r\n"], [107, "          Type: Api\r\n"], [108, "          Properties:\r\n"], [109, "            RestApiId: !Ref NotesApi\r\n"], [110, "            Path: /notes\r\n"], [111, "            Method: POST\r\n"], [112, "        NoteByIdOptions:\r\n"], [113, "          Type: Api\r\n"], [114, "          Properties:\r\n"], [115, "            RestApiId: !Ref NotesApi\r\n"], [116, "            Path: /notes/{id}\r\n"], [117, "            Method: OPTIONS\r\n"], [118, "            Auth:\r\n"], [119, "              Authorizer: NONE\r\n"], [120, "        UpdateNote:\r\n"], [121, "          Type: Api\r\n"], [122, "          Properties:\r\n"], [123, "            RestApiId: !Ref NotesApi\r\n"], [124, "            Path: /notes/{id}\r\n"], [125, "            Method: PUT\r\n"], [126, "        DeleteNote:\r\n"], [127, "          Type: Api\r\n"], [128, "          Properties:\r\n"], [129, "            RestApiId: !Ref NotesApi\r\n"], [130, "            Path: /notes/{id}\r\n"], [131, "            Method: DELETE\r\n"], [132, "      Policies:\r\n"], [133, "        - DynamoDBCrudPolicy:\r\n"], [134, "            TableName: !Ref DynamoDBTableName\r\n"], [135, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [136, "      Tags:\r\n"], [137, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [88, 137], "resource": "AWS::Serverless::Function.WriteNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[88, "  WriteNotesFunction:\r\n"], [89, "    Type: AWS::Serverless::Function\r\n"], [90, "    Properties:\r\n"], [91, "      FunctionName: !Sub 'notes-write-${Environment}'\r\n"], [92, "      CodeUri: .\r\n"], [93, "      Handler: dist/handlers/notes/writeHandler.handler\r\n"], [94, "      Environment:\r\n"], [95, "        Variables:\r\n"], [96, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [97, "      Events:\r\n"], [98, "        NotesOptions:\r\n"], [99, "          Type: Api\r\n"], [100, "          Properties:\r\n"], [101, "            RestApiId: !Ref NotesApi\r\n"], [102, "            Path: /notes\r\n"], [103, "            Method: OPTIONS\r\n"], [104, "            Auth:\r\n"], [105, "              Authorizer: NONE\r\n"], [106, "        CreateNote:\r\n"], [107, "          Type: Api\r\n"], [108, "          Properties:\r\n"], [109, "            RestApiId: !Ref NotesApi\r\n"], [110, "            Path: /notes\r\n"], [111, "            Method: POST\r\n"], [112, "        NoteByIdOptions:\r\n"], [113, "          Type: Api\r\n"], [114, "          Properties:\r\n"], [115, "            RestApiId: !Ref NotesApi\r\n"], [116, "            Path: /notes/{id}\r\n"], [117, "            Method: OPTIONS\r\n"], [118, "            Auth:\r\n"], [119, "              Authorizer: NONE\r\n"], [120, "        UpdateNote:\r\n"], [121, "          Type: Api\r\n"], [122, "          Properties:\r\n"], [123, "            RestApiId: !Ref NotesApi\r\n"], [124, "            Path: /notes/{id}\r\n"], [125, "            Method: PUT\r\n"], [126, "        DeleteNote:\r\n"], [127, "          Type: Api\r\n"], [128, "          Properties:\r\n"], [129, "            RestApiId: !Ref NotesApi\r\n"], [130, "            Path: /notes/{id}\r\n"], [131, "            Method: DELETE\r\n"], [132, "      Policies:\r\n"], [133, "        - DynamoDBCrudPolicy:\r\n"], [134, "            TableName: !Ref DynamoDBTableName\r\n"], [135, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [136, "      Tags:\r\n"], [137, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [88, 137], "resource": "AWS::Serverless::Function.WriteNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[88, "  WriteNotesFunction:\r\n"], [89, "    Type: AWS::Serverless::Function\r\n"], [90, "    Properties:\r\n"], [91, "      FunctionName: !Sub 'notes-write-${Environment}'\r\n"], [92, "      CodeUri: .\r\n"], [93, "      Handler: dist/handlers/notes/writeHandler.handler\r\n"], [94, "      Environment:\r\n"], [95, "        Variables:\r\n"], [96, "          TABLE_NAME: !Ref DynamoDBTableName\r\n"], [97, "      Events:\r\n"], [98, "        NotesOptions:\r\n"], [99, "          Type: Api\r\n"], [100, "          Properties:\r\n"], [101, "            RestApiId: !Ref NotesApi\r\n"], [102, "            Path: /notes\r\n"], [103, "            Method: OPTIONS\r\n"], [104, "            Auth:\r\n"], [105, "              Authorizer: NONE\r\n"], [106, "        CreateNote:\r\n"], [107, "          Type: Api\r\n"], [108, "          Properties:\r\n"], [109, "            RestApiId: !Ref NotesApi\r\n"], [110, "            Path: /notes\r\n"], [111, "            Method: POST\r\n"], [112, "        NoteByIdOptions:\r\n"], [113, "          Type: Api\r\n"], [114, "          Properties:\r\n"], [115, "            RestApiId: !Ref NotesApi\r\n"], [116, "            Path: /notes/{id}\r\n"], [117, "            Method: OPTIONS\r\n"], [118, "            Auth:\r\n"], [119, "              Authorizer: NONE\r\n"], [120, "        UpdateNote:\r\n"], [121, "          Type: Api\r\n"], [122, "          Properties:\r\n"], [123, "            RestApiId: !Ref NotesApi\r\n"], [124, "            Path: /notes/{id}\r\n"], [125, "            Method: PUT\r\n"], [126, "        DeleteNote:\r\n"], [127, "          Type: Api\r\n"], [128, "          Properties:\r\n"], [129, "            RestApiId: !Ref NotesApi\r\n"], [130, "            Path: /notes/{id}\r\n"], [131, "            Method: DELETE\r\n"], [132, "      Policies:\r\n"], [133, "        - DynamoDBCrudPolicy:\r\n"], [134, "            TableName: !Ref DynamoDBTableName\r\n"], [135, "        - CloudWatchLambdaInsightsExecutionRolePolicy\r\n"], [136, "      Tags:\r\n"], [137, "        Environment: !Ref Environment\r\n"]], "file_path": "/backend\\template.yaml", "file_abs_path": "backend/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [88, 137], "resource": "AWS::Serverless::Function.WriteNotesFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": {"Environment": "dev", "__file__": "backend/template.yaml"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Architectures": [{"type": "globals", "name": "Function", "path": "backend/template.yaml", "attribute_key": "Architectures"}], "Environment.Variables.TABLE_NAME": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy.TableName": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0.DynamoDBCrudPolicy": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Policies.0": [{"type": "parameters", "name": "DynamoDBTableName", "path": "backend/template.yaml", "attribute_key": "Default"}], "Tags.Environment": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}], "FunctionName": [{"type": "parameters", "name": "Environment", "path": "backend/template.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 5, "failed": 10, "skipped": 0, "parsing_errors": 0, "resource_count": 3, "checkov_version": "3.2.495"}}